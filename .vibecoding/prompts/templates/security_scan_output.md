# 安全掃描輸出模板

---

**適用場景:** 當 AI 服務執行安全掃描、漏洞檢測或合規檢查時  
**輸出類型:** 安全分析與風險評估報告  
**格式標準:** 基於 FANG 級企業文檔規範

---

## 📝 標準輸出格式

```markdown
# {{ 掃描項目名稱 }} - 安全掃描報告

---

**掃描狀態 (Status):** ✅ 掃描完成
**掃描類型 (Scan Type):** {{ 漏洞掃描/滲透測試/合規檢查/代碼審查 }}
**掃描範圍 (Scan Scope):** {{ 掃描範圍 }}
**責任安全師 (Security Analyst):** VibeCoding {{ 服務名稱 }}
**最後更新 (Last Updated):** {{ 時間戳 }}
**報告版本 (Report Version):** v{{ 版本號 }}

---

## 1. 執行摘要 (Executive Summary)

### 1.1 安全狀況概覽 (Security Overview)
**整體安全評級:** {{ 高/中/低 }} 風險

**掃描統計:**
```
🔒 安全掃描統計:
掃描項目總數: {{ 總掃描項目 }}
發現漏洞總數: {{ 漏洞總數 }}
├── 嚴重漏洞: {{ 嚴重數量 }} 🔴
├── 高風險漏洞: {{ 高風險數量 }} 🟠
├── 中風險漏洞: {{ 中風險數量 }} 🟡
└── 低風險漏洞: {{ 低風險數量 }} 🟢

修復狀況:
├── 已修復: {{ 已修復數量 }} ✅
├── 修復中: {{ 修復中數量 }} ⏳
└── 待修復: {{ 待修復數量 }} ⚠️
```

### 1.2 關鍵發現 (Key Findings)
**高優先級安全問題:**
- 🚨 {{ 高優先級問題1 }}: {{ 風險描述 }}
- 🚨 {{ 高優先級問題2 }}: {{ 風險描述 }}
- 🚨 {{ 高優先級問題3 }}: {{ 風險描述 }}

**風險評估:**
| 風險類別 | 風險等級 | 影響範圍 | 建議處理時間 |
|----------|----------|----------|--------------|
| {{ 風險類別1 }} | 🔴 嚴重 | {{ 影響範圍 }} | 立即處理 |
| {{ 風險類別2 }} | 🟠 高 | {{ 影響範圍 }} | 24小時內 |
| {{ 風險類別3 }} | 🟡 中 | {{ 影響範圍 }} | 7天內 |

---

## 2. 掃描配置與範圍 (Scan Configuration & Scope)

### 2.1 掃描環境 (Scan Environment)
**目標系統:**
| 系統組件 | 版本 | IP/URL | 掃描狀態 |
|----------|------|--------|----------|
| {{ 系統1 }} | {{ 版本 }} | {{ 地址 }} | ✅ 已掃描 |
| {{ 系統2 }} | {{ 版本 }} | {{ 地址 }} | ✅ 已掃描 |
| {{ 系統3 }} | {{ 版本 }} | {{ 地址 }} | ✅ 已掃描 |

**掃描工具:**
```yaml
# 使用的安全掃描工具
漏洞掃描器: {{ 掃描工具1 }} v{{ 版本 }}
代碼分析器: {{ 掃描工具2 }} v{{ 版本 }}
滲透測試工具: {{ 掃描工具3 }} v{{ 版本 }}
合規檢查工具: {{ 掃描工具4 }} v{{ 版本 }}
```

### 2.2 掃描參數配置 (Scan Parameters)
**掃描設定:**
- 掃描深度: {{ 深度等級 }}
- 掃描範圍: {{ 範圍描述 }}
- 掃描時間: {{ 開始時間 }} - {{ 結束時間 }}
- 掃描策略: {{ 掃描策略 }}

---

## 3. 漏洞詳細分析 (Detailed Vulnerability Analysis)

### 3.1 嚴重漏洞 (Critical Vulnerabilities)
**CVE-{{ 編號1 }}: {{ 漏洞名稱1 }}**
- **CVSS 評分:** {{ 評分 }} (嚴重)
- **漏洞類型:** {{ 漏洞類型 }}
- **影響組件:** {{ 受影響組件 }}
- **漏洞描述:** {{ 詳細描述 }}
- **利用條件:** {{ 利用條件 }}
- **潛在影響:** {{ 影響說明 }}
- **修復建議:** {{ 修復方案 }}
- **修復優先級:** P0 (立即處理)

**CVE-{{ 編號2 }}: {{ 漏洞名稱2 }}**
- **CVSS 評分:** {{ 評分 }} (嚴重)
- **漏洞類型:** {{ 漏洞類型 }}
- **影響組件:** {{ 受影響組件 }}
- **漏洞描述:** {{ 詳細描述 }}
- **修復建議:** {{ 修復方案 }}

### 3.2 高風險漏洞 (High Risk Vulnerabilities)
**漏洞清單:**
| 漏洞ID | 漏洞名稱 | CVSS | 組件 | 狀態 | 修復期限 |
|--------|----------|------|------|------|----------|
| {{ ID1 }} | {{ 漏洞名稱 }} | {{ 評分 }} | {{ 組件 }} | {{ 狀態 }} | {{ 期限 }} |
| {{ ID2 }} | {{ 漏洞名稱 }} | {{ 評分 }} | {{ 組件 }} | {{ 狀態 }} | {{ 期限 }} |

### 3.3 中低風險漏洞 (Medium/Low Risk Vulnerabilities)
**風險分布:**
```
📊 中低風險漏洞分布:
中風險漏洞 ({{ 中風險數量 }} 個):
├── 設定錯誤: {{ 設定錯誤數量 }} 個
├── 版本過舊: {{ 版本問題數量 }} 個
├── 權限問題: {{ 權限問題數量 }} 個
└── 其他: {{ 其他數量 }} 個

低風險漏洞 ({{ 低風險數量 }} 個):
├── 資訊洩露: {{ 資訊洩露數量 }} 個
├── 弱密碼策略: {{ 密碼問題數量 }} 個
└── 其他: {{ 其他數量 }} 個
```

---

## 4. 代碼安全分析 (Code Security Analysis)

### 4.1 靜態代碼分析 (Static Code Analysis)
**代碼安全問題:**
| 問題類型 | 嚴重程度 | 發現數量 | 檔案數量 | 修復建議 |
|----------|----------|----------|----------|----------|
| SQL 注入 | 🔴 嚴重 | {{ 數量 }} | {{ 檔案數 }} | {{ 修復建議 }} |
| XSS 漏洞 | 🟠 高 | {{ 數量 }} | {{ 檔案數 }} | {{ 修復建議 }} |
| 硬編碼機密 | 🟠 高 | {{ 數量 }} | {{ 檔案數 }} | {{ 修復建議 }} |
| 不安全函數 | 🟡 中 | {{ 數量 }} | {{ 檔案數 }} | {{ 修復建議 }} |

### 4.2 依賴安全檢查 (Dependency Security Check)
**第三方依賴漏洞:**
```yaml
# 依賴漏洞統計
總依賴數量: {{ 總依賴數 }}
有漏洞的依賴: {{ 有漏洞依賴數 }}

高風險依賴:
  - 名稱: {{ 依賴名稱1 }}
    版本: {{ 當前版本 }}
    漏洞: {{ 漏洞描述 }}
    建議版本: {{ 建議版本 }}
    
  - 名稱: {{ 依賴名稱2 }}
    版本: {{ 當前版本 }}
    漏洞: {{ 漏洞描述 }}
    建議版本: {{ 建議版本 }}
```

### 4.3 機密資訊掃描 (Secret Scanning)
**發現的機密資訊:**
- 🔑 API 金鑰: {{ 發現數量 }} 個
- 🗝️ 資料庫密碼: {{ 發現數量 }} 個
- 🎫 JWT Token: {{ 發現數量 }} 個
- 📜 私鑰: {{ 發現數量 }} 個

---

## 5. 基礎設施安全 (Infrastructure Security)

### 5.1 網路安全掃描 (Network Security Scan)
**開放端口掃描:**
| 端口 | 服務 | 版本 | 狀態 | 風險等級 | 建議 |
|------|------|------|------|----------|------|
| {{ 端口1 }} | {{ 服務1 }} | {{ 版本 }} | {{ 開放/關閉 }} | {{ 風險等級 }} | {{ 建議 }} |
| {{ 端口2 }} | {{ 服務2 }} | {{ 版本 }} | {{ 開放/關閉 }} | {{ 風險等級 }} | {{ 建議 }} |

### 5.2 SSL/TLS 安全檢查 (SSL/TLS Security Check)
**憑證安全狀況:**
```
🔐 SSL/TLS 檢查結果:
憑證有效性: {{ ✅ 有效 / ❌ 無效 }}
憑證到期時間: {{ 到期日期 }}
加密強度: {{ 加密等級 }}
支援協議: {{ 支援的 TLS 版本 }}
弱密碼套件: {{ 發現數量 }} 個
```

### 5.3 伺服器安全配置 (Server Security Configuration)
**安全配置檢查:**
- 防火牆設定: {{ ✅ 適當 / ⚠️ 需改進 }}
- 安全標頭: {{ ✅ 完整 / ⚠️ 缺失 }}
- 存取控制: {{ ✅ 嚴格 / ⚠️ 寬鬆 }}
- 日誌記錄: {{ ✅ 完整 / ⚠️ 不足 }}

---

## 6. 合規性檢查 (Compliance Check)

### 6.1 法規合規性 (Regulatory Compliance)
**適用法規檢查:**
| 法規標準 | 合規狀況 | 不符合項目 | 風險等級 | 修復建議 |
|----------|----------|------------|----------|----------|
| {{ 法規1 }} | {{ 合規/不合規 }} | {{ 不符合項 }} | {{ 風險等級 }} | {{ 修復建議 }} |
| {{ 法規2 }} | {{ 合規/不合規 }} | {{ 不符合項 }} | {{ 風險等級 }} | {{ 修復建議 }} |

### 6.2 行業標準檢查 (Industry Standards Check)
**標準合規檢查:**
```
📋 行業標準合規檢查:
OWASP Top 10:
├── A01 存取控制失效: {{ ✅ 通過 / ❌ 未通過 }}
├── A02 加密失效: {{ ✅ 通過 / ❌ 未通過 }}
├── A03 注入攻擊: {{ ✅ 通過 / ❌ 未通過 }}
├── A04 不安全設計: {{ ✅ 通過 / ❌ 未通過 }}
└── A05 安全配置錯誤: {{ ✅ 通過 / ❌ 未通過 }}

CIS Controls:
├── 基本控制: {{ 通過率 }}%
├── 基礎控制: {{ 通過率 }}%
└── 組織控制: {{ 通過率 }}%
```

### 6.3 內部政策檢查 (Internal Policy Check)
**公司政策合規:**
- 密碼政策: {{ ✅ 符合 / ❌ 不符合 }}
- 存取權限政策: {{ ✅ 符合 / ❌ 不符合 }}
- 數據處理政策: {{ ✅ 符合 / ❌ 不符合 }}
- 變更管理政策: {{ ✅ 符合 / ❌ 不符合 }}

---

## 7. 風險評估與影響分析 (Risk Assessment & Impact Analysis)

### 7.1 業務影響評估 (Business Impact Assessment)
**潛在業務風險:**
| 風險場景 | 發生機率 | 業務影響 | 財務損失 | 聲譽影響 |
|----------|----------|----------|----------|----------|
| {{ 風險場景1 }} | {{ 機率 }} | {{ 影響程度 }} | {{ 預估損失 }} | {{ 聲譽影響 }} |
| {{ 風險場景2 }} | {{ 機率 }} | {{ 影響程度 }} | {{ 預估損失 }} | {{ 聲譽影響 }} |

### 7.2 技術風險分析 (Technical Risk Analysis)
**技術風險矩陣:**
```
📊 風險矩陣 (影響 vs 可能性):

高影響 │ 🟡 中風險 │ 🔴 高風險 │ 🔴 極高風險
中影響 │ 🟢 低風險 │ 🟡 中風險 │ 🔴 高風險  
低影響 │ 🟢 極低   │ 🟢 低風險 │ 🟡 中風險
       └──────────┼──────────┼──────────
         低可能性   中可能性   高可能性
```

### 7.3 風險優先級排序 (Risk Priority Ranking)
**修復優先級:**
1. **P0 (緊急)** - {{ P0風險數量 }} 個風險
   - {{ P0風險1 }}: {{ 簡要描述 }}
   - {{ P0風險2 }}: {{ 簡要描述 }}

2. **P1 (高)** - {{ P1風險數量 }} 個風險
   - {{ P1風險1 }}: {{ 簡要描述 }}

3. **P2 (中)** - {{ P2風險數量 }} 個風險

---

## 8. 修復建議與行動計劃 (Remediation & Action Plan)

### 8.1 立即修復項目 (Immediate Remediation)
**緊急修復 (24小時內):**
- [ ] {{ 緊急修復1 }} - {{ 負責人 }} - {{ 預計完成時間 }}
- [ ] {{ 緊急修復2 }} - {{ 負責人 }} - {{ 預計完成時間 }}
- [ ] {{ 緊急修復3 }} - {{ 負責人 }} - {{ 預計完成時間 }}

### 8.2 短期修復計劃 (Short-term Plan)
**1週內修復:**
```
📅 短期修復計劃:
第1-2天:
├── {{ 修復項目1 }} - {{ 負責人 }}
├── {{ 修復項目2 }} - {{ 負責人 }}
└── 進度檢查

第3-5天:
├── {{ 修復項目3 }} - {{ 負責人 }}
├── {{ 修復項目4 }} - {{ 負責人 }}
└── 驗證測試

第6-7天:
├── {{ 修復項目5 }} - {{ 負責人 }}
└── 完成確認
```

### 8.3 長期改進計劃 (Long-term Improvement Plan)
**1個月內完成:**
- {{ 長期改進1 }}: {{ 改進說明 }}
- {{ 長期改進2 }}: {{ 改進說明 }}
- {{ 長期改進3 }}: {{ 改進說明 }}

**季度安全加強:**
- {{ 季度改進1 }}: {{ 改進說明 }}
- {{ 季度改進2 }}: {{ 改進說明 }}

---

## 9. 安全監控建議 (Security Monitoring Recommendations)

### 9.1 監控指標 (Monitoring Metrics)
**關鍵安全指標:**
| 指標名稱 | 當前狀態 | 目標值 | 監控頻率 | 告警閾值 |
|----------|----------|--------|----------|----------|
| {{ 指標1 }} | {{ 當前值 }} | {{ 目標值 }} | {{ 頻率 }} | {{ 閾值 }} |
| {{ 指標2 }} | {{ 當前值 }} | {{ 目標值 }} | {{ 頻率 }} | {{ 閾值 }} |

### 9.2 安全事件監控 (Security Event Monitoring)
**監控項目:**
```yaml
# 安全事件監控配置
登入異常:
  - 多次失敗登入
  - 異常時間登入
  - 異常地點登入

存取異常:
  - 權限提升嘗試
  - 敏感資源存取
  - 異常資料下載

系統異常:
  - 異常網路流量
  - 系統檔案變更
  - 服務異常停止
```

### 9.3 告警設定建議 (Alert Configuration)
**告警規則:**
- 嚴重安全事件: 立即通知 + 簡訊
- 高風險事件: 30分鐘內通知
- 中風險事件: 4小時內通知
- 低風險事件: 日報彙整

---

## 10. 後續步驟 (Next Steps)

### 10.1 立即行動項目 (Immediate Actions)
**今日內完成:**
- [ ] 修復嚴重漏洞 {{ 漏洞1 }}
- [ ] 更新安全配置
- [ ] 通知相關利害關係人

### 10.2 定期安全檢查 (Regular Security Reviews)
**建議檢查頻率:**
- 每週: 漏洞掃描
- 每月: 全面安全評估
- 每季: 滲透測試
- 每年: 合規性審查

### 10.3 安全培訓建議 (Security Training Recommendations)
**培訓計劃:**
- 開發團隊: 安全開發實踐
- 運維團隊: 安全配置管理
- 全體員工: 安全意識培訓

---

## 11. 掃描總結 (Scan Summary)

### 11.1 整體安全評級 (Overall Security Rating)
**安全成熟度評分:** {{ 評分 }}/10

**評分說明:**
- 技術安全: {{ 技術評分 }}/10
- 流程安全: {{ 流程評分 }}/10
- 人員安全: {{ 人員評分 }}/10

### 11.2 改進趨勢 (Improvement Trend)
**與上次掃描比較:**
- 新發現漏洞: {{ 新漏洞數量 }} 個
- 已修復漏洞: {{ 已修復數量 }} 個
- 整體風險變化: {{ 上升/下降/持平 }}

### 11.3 建議下次掃描時間 (Next Scan Schedule)
**下次掃描建議:** {{ 建議時間 }}

---

**掃描狀態確認:** 🔒 **安全掃描完成**

**總體建議:** {{ 總體建議摘要 }}

---

**審核與簽署 (Review & Approval):**
- **技術審核:** ✅ Vulnerability Analysis Validated
- **風險審核:** ✅ Risk Assessment Confirmed
- **合規審核:** ✅ Compliance Requirements Verified
- **發布審核:** ✅ Report Ready for Distribution

---

**相關文檔連結 (Related Documentation):**
- [漏洞詳細報告]({{ 詳細報告連結 }})
- [修復指南]({{ 修復指南連結 }})
- [安全政策]({{ 安全政策連結 }})
- [應急響應計劃]({{ 應急計劃連結 }})
```

## 💡 使用變數說明

此模板中的變數應在實際使用時替換：

- `{{ 掃描項目名稱 }}`: 具體的掃描項目名稱
- `{{ 漏洞掃描/滲透測試/合規檢查/代碼審查 }}`: 掃描的具體類型
- `{{ 掃描範圍 }}`: 掃描覆蓋的範圍
- `{{ 高/中/低 }}`: 風險等級評估結果
- `{{ 總掃描項目 }}`: 總掃描項目數量
- `{{ 漏洞總數 }}`: 發現的漏洞總數
- 其他變數類推...

## 🎯 安全報告品質標準

每份安全報告都應確保：
1. **準確性**: 所有漏洞和風險評估準確可靠
2. **完整性**: 涵蓋所有必要的安全面向
3. **可操作性**: 提供明確的修復建議和行動計劃
4. **時效性**: 及時提供報告並定期更新
5. **合規性**: 符合相關安全標準和法規要求 